{"version":3,"sources":["../../src/frontend/renderer.js"],"names":["WIDTH","sm_to_px","HEIGHT","MARGIN","app","render","field","createApp","drawBorder","i","drawText","String","fromCharCode","charCodeAt","j","drawCross","drawParkingZone","parkingZone","drawBox","boxes","Color","boxColors","value","p","point","add","cubeColors","descr","document","getElementById","parkingZoneDescr","createElement","dir","x","parkingZoneDirection","y","appendChild","createTextNode","boxDescr","p1","p2","initPixi","canvas","PIXI","Application","width","height","view","renderer","backgroundColor","type","utils","isWebGLSupported","sayHello","border","Graphics","lineStyle","moveTo","lineTo","stage","addChild","sm","size","p3","p4","arguments","length","push","pivot","position","color","fill","beginFill","drawRect","endFill","text","textObj","Text","fontFamily","fontSize","align"],"mappings":"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","sourcesContent":["\n'use strict';\n\nimport * as PIXI from 'pixi.js';\nimport Color from '../util/color';\nimport {encodePoint} from '../util/encode_field';\n\nconst WIDTH = sm_to_px(2300)+1;\nconst HEIGHT = sm_to_px(2300)+1;\n\nconst MARGIN = 30;\n\nvar app = null;\n\n\n\nexport function render(field) {\n    createApp();\n\n    drawBorder();\n\n    // draw letters on field border (as in the sea battle game)\n    for (let i = 1; i <= 20; i++) {\n        drawText(i * sm_to_px(115), 10, String.fromCharCode('A'.charCodeAt(0) + i - 1));\n        drawText(10, i * sm_to_px(115), String.fromCharCode('A'.charCodeAt(0) + i - 1));\n    }\n\n    // draw crosses on the field\n    for (let i = sm_to_px(115); i <= sm_to_px(2300); i += sm_to_px(115)) {\n        for (let j = sm_to_px(115); j <= sm_to_px(2300); j += sm_to_px(115)) {\n            drawCross(MARGIN + i, MARGIN + j, 5);\n        }\n    }\n\n    drawParkingZone(...field.parkingZone);\n    for(let i = 0; i < 5; i++) {\n        drawBox(field.boxes[i], Color[field.boxColors[i]].value);\n        for(let p of [point(115 - 30, 0), point(0, 115 - 30), point(230 - 60, 115 - 30), point(115 - 30, 230 - 60)]) {\n            drawBox(add(field.boxes[i], p), Color[field.cubeColors[i]].value, 60);\n        }\n    }\n\n    // draw strings with field element coordinates\n    let descr = document.getElementById(\"field-descr\");\n    let parkingZoneDescr = document.createElement(\"p\");\n    let dir = {x: field.parkingZone[0].x + field.parkingZoneDirection.x,\n               y: field.parkingZone[0].y + field.parkingZoneDirection.y};\n    parkingZoneDescr.appendChild(document.createTextNode(\n        \"Parking Zone: \" + encodePoint(field.parkingZone[0]) + \" \" + encodePoint(dir)));\n    descr.appendChild(parkingZoneDescr);\n    for(let i = 0; i < 5; i++) {\n        let boxDescr = document.createElement(\"p\");\n        boxDescr.appendChild(document.createTextNode(field.boxColors[i] + \": \" + encodePoint(field.boxes[i])));\n        descr.appendChild(boxDescr);\n    }\n}\n\n\n\nfunction add(p1, p2) {\n    return {x: p1.x + p2.x, y: p1.y + p2.y};\n}\n\n\n\nfunction point(x, y) {\n    return {x: x, y: y};\n}\n\n\n\nfunction createApp() {\n    initPixi();\n    let canvas = document.getElementById(\"field-canvas\");\n    app = new PIXI.Application({width: MARGIN + WIDTH, height: MARGIN + HEIGHT, view: canvas});\n    app.renderer.backgroundColor = 0xFFFFFF;\n}\n\n\n\nfunction initPixi() {\n    let type = \"WebGL\";\n\n    if(!PIXI.utils.isWebGLSupported()){\n        type = \"canvas\";\n    }\n\n    PIXI.utils.sayHello(type);\n}\n\n\n\nfunction drawBorder() {\n    let border = new PIXI.Graphics();\n\n    border.lineStyle(5, 0x000000);\n\n    border.moveTo(MARGIN, MARGIN);\n    border.lineTo(MARGIN + WIDTH - 3, MARGIN);\n    border.lineTo(MARGIN + WIDTH - 3, MARGIN + HEIGHT - 3);\n    border.lineTo(MARGIN, MARGIN + HEIGHT - 3);\n    border.lineTo(MARGIN, MARGIN);\n\n    app.stage.addChild(border);\n}\n\n\n\nfunction sm_to_px(sm) {\n    return sm / 4.0;\n}\n\nfunction drawCross(x, y, size) {\n    let border = new PIXI.Graphics();\n\n    border.lineStyle(1, 0x000000);\n\n    border.moveTo(x - size / 2, y);\n    border.lineTo(x + size / 2, y);\n    border.moveTo(x, y - size / 2);\n    border.lineTo(x, y + size / 2);\n\n    app.stage.addChild(border);\n}\n\n\nfunction drawParkingZone(p1, p2, p3, p4) {\n    let p = [];\n    for (let i = 0; i < arguments.length; i++) {\n        p.push({ x: MARGIN + sm_to_px(arguments[i].x),\n                 y: MARGIN + sm_to_px(arguments[i].y) });\n    }\n    let border = new PIXI.Graphics();\n\n    border.lineStyle(3, 0x00AA00);\n    border.moveTo(0, 0);\n    border.lineTo(p[1].x - p[0].x, p[1].y - p[0].y);\n\n    border.lineStyle(3, 0x000000);\n    border.lineTo(p[2].x - p[0].x, p[2].y - p[0].y);\n    border.lineTo(p[3].x - p[0].x, p[3].y - p[0].y);\n\n    border.pivot.x = (p[2].x - p[0].x) / 2;\n    border.pivot.y = (p[2].y - p[0].y) / 2;\n\n    border.position.x = (p[0].x + p[2].x) / 2;\n    border.position.y = (p[0].y + p[2].y) / 2;\n\n    app.stage.addChild(border);\n}\n\n\n\nfunction drawBox(point, color=0x0000FF, size=230, fill=true) {\n    let border = new PIXI.Graphics();\n\n    border.lineStyle(1, 0x000000);\n    if(fill) border.beginFill(color);\n    border.drawRect(MARGIN + sm_to_px(point.x), MARGIN + sm_to_px(point.y), sm_to_px(size), sm_to_px(size));\n    if(fill) border.endFill();\n\n    app.stage.addChild(border);\n}\n\n\n\nfunction drawText(x, y, text) {\n    let textObj = new PIXI.Text(text, {fontFamily : 'Arial', fontSize: 9, fill : 0xff1010, align : 'center'});\n    textObj.x = x;\n    textObj.y = y;\n\n    app.stage.addChild(textObj);\n}\n"],"file":"renderer.js"}